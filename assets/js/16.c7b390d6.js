(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{287:function(a,t,r){"use strict";r.r(t);var s=r(13),v=Object(s.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"_5-寻址-堆栈"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-寻址-堆栈"}},[a._v("#")]),a._v(" 5.寻址&堆栈")]),a._v(" "),t("h2",{attrs:{id:"寻址"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#寻址"}},[a._v("#")]),a._v(" 寻址")]),a._v(" "),t("h3",{attrs:{id:"寻址公式一-立即数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#寻址公式一-立即数"}},[a._v("#")]),a._v(" 寻址公式一：[立即数]")]),a._v(" "),t("h4",{attrs:{id:"读取内存的值"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#读取内存的值"}},[a._v("#")]),a._v(" 读取内存的值：")]),a._v(" "),t("ul",[t("li",[a._v("MOV EAX,DWORD PTR DS:[0x13FFC4]")]),a._v(" "),t("li",[a._v("MOV EAX,DWORD PTR DS:[0x13FFC8]")])]),a._v(" "),t("h4",{attrs:{id:"向内存中写入数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#向内存中写入数据"}},[a._v("#")]),a._v(" 向内存中写入数据：")]),a._v(" "),t("ul",[t("li",[a._v("MOV DWORD PTR DS:[0x13FFC4],eax")]),a._v(" "),t("li",[a._v("MOV DWORD PTR DS:[0x13FFC8],ebx")])]),a._v(" "),t("h4",{attrs:{id:"获取内存编号"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获取内存编号"}},[a._v("#")]),a._v(" 获取内存编号：")]),a._v(" "),t("ul",[t("li",[a._v("LEA EAX,DWORD PTR DS:[0X13FFC4]")]),a._v(" "),t("li",[a._v("LEA EAX,DWORD PTR DS:[ESP+8]")])]),a._v(" "),t("h3",{attrs:{id:"寻址公式二-reg-reg-代表寄存器-可以是-8-个通用寄存器中的任意一个"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#寻址公式二-reg-reg-代表寄存器-可以是-8-个通用寄存器中的任意一个"}},[a._v("#")]),a._v(" 寻址公式二：[reg] reg 代表寄存器 可以是 8 个通用寄存器中的任意一个")]),a._v(" "),t("h4",{attrs:{id:"读取内存的值-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#读取内存的值-2"}},[a._v("#")]),a._v(" 读取内存的值：")]),a._v(" "),t("ul",[t("li",[a._v("MOV ECX,0x13FFD0")]),a._v(" "),t("li",[a._v("MOV EAX,DWORD PTR DS:[ECX]")])]),a._v(" "),t("h4",{attrs:{id:"向内存中写入数据-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#向内存中写入数据-2"}},[a._v("#")]),a._v(" 向内存中写入数据：")]),a._v(" "),t("ul",[t("li",[a._v("MOV EDX,0x13FFD8")]),a._v(" "),t("li",[a._v("MOV DWORD PTR DS:[EDX],0x87654321")])]),a._v(" "),t("h4",{attrs:{id:"获取内存编号-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获取内存编号-2"}},[a._v("#")]),a._v(" 获取内存编号：")]),a._v(" "),t("ul",[t("li",[a._v("LEA EAX,DWORD PTR DS:[EDX]")]),a._v(" "),t("li",[a._v("MOV EAX,DWORD PTR DS:[EDX]")])]),a._v(" "),t("h3",{attrs:{id:"寻址公式三-reg-立即数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#寻址公式三-reg-立即数"}},[a._v("#")]),a._v(" 寻址公式三：[reg+立即数]")]),a._v(" "),t("h4",{attrs:{id:"读取内存的值-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#读取内存的值-3"}},[a._v("#")]),a._v(" 读取内存的值：")]),a._v(" "),t("ul",[t("li",[a._v("MOV ECX,0x13FFD0")]),a._v(" "),t("li",[a._v("MOV EAX,DWORD PTR DS:[ECX+4]")])]),a._v(" "),t("h4",{attrs:{id:"向内存中写入数据-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#向内存中写入数据-3"}},[a._v("#")]),a._v(" 向内存中写入数据：")]),a._v(" "),t("ul",[t("li",[a._v("MOV EDX,0x13FFD8")]),a._v(" "),t("li",[a._v("MOV DWORD PTR DS:[EDX+0xC],0x87654321")])]),a._v(" "),t("h4",{attrs:{id:"获取内存编号-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获取内存编号-3"}},[a._v("#")]),a._v(" 获取内存编号：")]),a._v(" "),t("ul",[t("li",[a._v("LEA EAX,DWORD PTR DS:[EDX+4]")]),a._v(" "),t("li",[a._v("MOV EAX,DWORD PTR DS:[EDX+4]")])]),a._v(" "),t("h3",{attrs:{id:"寻址公式四-reg-reg-1-2-4-8"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#寻址公式四-reg-reg-1-2-4-8"}},[a._v("#")]),a._v(" 寻址公式四：[reg+reg*{1,2,4,8}]")]),a._v(" "),t("h4",{attrs:{id:"读取内存的值-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#读取内存的值-4"}},[a._v("#")]),a._v(" 读取内存的值：")]),a._v(" "),t("ul",[t("li",[a._v("MOV EAX,13FFC4")]),a._v(" "),t("li",[a._v("MOV ECX,2")]),a._v(" "),t("li",[a._v("MOV EDX,DWORD PTR DS:[EAX+ECX*4]")])]),a._v(" "),t("h4",{attrs:{id:"向内存中写入数据-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#向内存中写入数据-4"}},[a._v("#")]),a._v(" 向内存中写入数据：")]),a._v(" "),t("ul",[t("li",[a._v("MOV EAX,13FFC4")]),a._v(" "),t("li",[a._v("MOV ECX,2")]),a._v(" "),t("li",[a._v("MOV DWORD PTR DS:[EAX+ECX*4],87654321")])]),a._v(" "),t("h4",{attrs:{id:"获取内存编号-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获取内存编号-4"}},[a._v("#")]),a._v(" 获取内存编号：")]),a._v(" "),t("ul",[t("li",[a._v("LEA EAX,DWORD PTR DS:[EAX+ECX*4]")])]),a._v(" "),t("h3",{attrs:{id:"寻址公式五-reg-reg-1-2-4-8-立即数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#寻址公式五-reg-reg-1-2-4-8-立即数"}},[a._v("#")]),a._v(" 寻址公式五：[reg+reg*{1,2,4,8}+立即数]")]),a._v(" "),t("h4",{attrs:{id:"读取内存的值-5"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#读取内存的值-5"}},[a._v("#")]),a._v(" 读取内存的值：")]),a._v(" "),t("ul",[t("li",[a._v("MOV EAX,13FFC4")]),a._v(" "),t("li",[a._v("MOV ECX,2")]),a._v(" "),t("li",[a._v("MOV EDX,DWORD PTR DS:[EAX+ECX*4+4]")])]),a._v(" "),t("h4",{attrs:{id:"向内存中写入数据-5"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#向内存中写入数据-5"}},[a._v("#")]),a._v(" 向内存中写入数据：")]),a._v(" "),t("ul",[t("li",[a._v("MOV EAX,13FFC4")]),a._v(" "),t("li",[a._v("MOV ECX,2")]),a._v(" "),t("li",[a._v("MOV DWORD PTR DS:[EAX+ECX*4+4],87654321")])]),a._v(" "),t("h4",{attrs:{id:"获取内存编号-5"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获取内存编号-5"}},[a._v("#")]),a._v(" 获取内存编号：")]),a._v(" "),t("ul",[t("li",[a._v("LEA EAX,DWORD PTR DS:[EAX+ECX*4+2]")])]),a._v(" "),t("h2",{attrs:{id:"堆栈"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#堆栈"}},[a._v("#")]),a._v(" 堆栈")]),a._v(" "),t("h3",{attrs:{id:"什么是堆栈"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是堆栈"}},[a._v("#")]),a._v(" 什么是堆栈")]),a._v(" "),t("img",{attrs:{src:"https://raw.githubusercontent.com/Amyas/picgo-bed/master/amyas.github.io/52022-09-02-11-23-17.png",alt:"52022-09-02-11-23-17",width:"",height:""}}),a._v(" "),t("h4",{attrs:{id:"步骤一-压入数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#步骤一-压入数据"}},[a._v("#")]),a._v(" 步骤一：压入数据")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[a._v("MOV EBX,13FFDC\t\t\tBASE\nMOV EDX,13FFDC\t\t\tTOP\n\n方式一：\n\nMOV DWORD PTR DS:[EDX-4],0xAAAAAAAA\nSUB EDX,4\n\n方式二：\n\nSUB EDX,4\nMOV DWORD PTR DS:[EDX],0xBBBBBBBB\n\n方式三：\n\nMOV DWORD PTR DS:[EDX-4],0xDDDDDDDD\nLEA EDX,DWORD PTR DS:[EDX-4]\n\n方式四：\n\nLEA EDX,DWORD PTR DS:[EDX-4]\nMOV DWORD PTR DS:[EDX],0xEEEEEEEE\n")])])]),t("h4",{attrs:{id:"步骤二-读取第-n-个数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#步骤二-读取第-n-个数"}},[a._v("#")]),a._v(" 步骤二：读取第 N 个数")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[a._v("1、方式一：通过Base加偏移来读取\n\n读第一个压入的数据：\n\nMOV ESI,DWORD PTR DS:[EBX-4]\n\n读第四个压入的数据：\n\nMOV ESI,DWORD PTR DS:[EBX-0x10]\n\n\n2、方式二：通过Top加偏移来读取\n\n读第二个压入的数据：\n\nMOV EDI,DWORD PTR DS:[EDX+4]\n\n读第三个压入的数据：\n\nMOV EDI,DWORD PTR DS:[EDX+8]\n")])])]),t("h4",{attrs:{id:"步骤三-弹出数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#步骤三-弹出数据"}},[a._v("#")]),a._v(" 步骤三：弹出数据")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[a._v("MOV ECX,DWORD PTR DS:[EDX]\nLEA EDX,DWORD PTR DS:[EDX+4]\n\nMOV ESI,DWORD PTR DS:[EDX]\nADD EDX,4\n\nLEA EDX,DWORD PTR DS:[EDX+4]\nMOV EDI,DWORD PTR DS:[EDX-4]\n")])])]),t("h3",{attrs:{id:"堆栈操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#堆栈操作"}},[a._v("#")]),a._v(" 堆栈操作")]),a._v(" "),t("img",{attrs:{src:"https://raw.githubusercontent.com/Amyas/picgo-bed/master/amyas.github.io/52022-09-02-11-24-45.png",alt:"52022-09-02-11-24-45",width:"",height:""}})])}),[],!1,null,null,null);t.default=v.exports}}]);